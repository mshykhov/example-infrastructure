# =============================================================================
# TRAEFIK HELM VALUES
# =============================================================================
# Docs: https://github.com/traefik/traefik-helm-chart
#
# Architecture:
# - Primary Service: MetalLB LoadBalancer (public)
#   - IP: 192.168.8.240 (from MetalLB pool)
#   - TLS via cert-manager + Let's Encrypt
#   - Routes: api.example.com → example-api
#
# - Additional Service: Tailscale LoadBalancer (internal)
#   - TLS terminated by Tailscale proxy
#   - Routes: longhorn, prometheus, alertmanager (Phase 6+)
#
# Prerequisites for public access:
# 1. Domain with DNS A record → your public IP
# 2. Router port forwarding: 80,443 → 192.168.8.240
# =============================================================================

ingressClass:
  enabled: true
  isDefaultClass: true

# Providers
providers:
  kubernetesCRD:
    enabled: true
    allowCrossNamespace: true
    allowExternalNameServices: true
  kubernetesIngress:
    enabled: true
    publishedService:
      enabled: true

# Entrypoints
ports:
  web:
    port: 8000
    expose:
      default: true
      internal: true
    exposedPort: 80
    protocol: TCP
    redirectTo:
      port: websecure
      priority: 10
  websecure:
    port: 8443
    expose:
      default: true
      internal: true
    exposedPort: 443
    protocol: TCP
    tls:
      enabled: true

# Primary Service: MetalLB (public access)
service:
  enabled: true
  type: LoadBalancer
  annotations: {}
  labels: {}
  spec: {}
  # Additional Service: Tailscale (internal access)
  additionalServices:
    internal:
      type: LoadBalancer
      annotations:
        tailscale.com/hostname: "traefik"
      labels:
        traefik-service-label: internal
      spec:
        loadBalancerClass: tailscale

# Logs
logs:
  general:
    level: INFO
  access:
    enabled: true

# Resources
resources:
  requests:
    cpu: "100m"
    memory: "128Mi"
  limits:
    cpu: "500m"
    memory: "256Mi"

# Pod disruption budget
podDisruptionBudget:
  enabled: false

# Replicas
deployment:
  replicas: 1
