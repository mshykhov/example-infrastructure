# =============================================================================
# TRAEFIK HELM VALUES
# =============================================================================
# Docs: https://github.com/traefik/traefik-helm-chart
#
# Architecture:
# - Internal Service: Tailscale LoadBalancer (traefik.tail876052.ts.net)
#   - TLS terminated by Tailscale proxy (auto Let's Encrypt)
#   - ForwardAuth middleware → oauth2-proxy → Auth0 (Phase 6)
#   - Routes: longhorn, prometheus, alertmanager
#
# - Public Service: MetalLB LoadBalancer (future)
#   - TLS via cert-manager + Let's Encrypt
#   - Routes: api.example.com
# =============================================================================

# IngressClass - don't set as default (tailscale is default for now)
ingressClass:
  enabled: true
  isDefaultClass: false

# Providers
providers:
  kubernetesCRD:
    enabled: true
    allowCrossNamespace: true
    allowExternalNameServices: true
  kubernetesIngress:
    enabled: false

# Entrypoints
# Tailscale proxy terminates TLS, Traefik receives HTTP
ports:
  web:
    port: 8000
    expose:
      default: true
    exposedPort: 80
    protocol: TCP
  websecure:
    port: 8443
    expose:
      default: true
    exposedPort: 443
    protocol: TCP
    tls:
      enabled: false

# Service configuration
# Tailscale LoadBalancer for internal access
# Creates tailnet node: traefik.tail876052.ts.net
service:
  enabled: true
  type: LoadBalancer
  annotations:
    tailscale.com/hostname: "traefik"
  labels: {}
  spec:
    loadBalancerClass: tailscale

# Logs
logs:
  general:
    level: INFO
  access:
    enabled: true

# Resources
resources:
  requests:
    cpu: "100m"
    memory: "128Mi"
  limits:
    cpu: "500m"
    memory: "256Mi"

# Pod disruption budget
podDisruptionBudget:
  enabled: false

# Replicas
deployment:
  replicas: 1
