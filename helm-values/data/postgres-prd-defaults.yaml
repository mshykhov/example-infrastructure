# =============================================================================
# POSTGRESQL CLUSTER DEFAULTS - PRD ENVIRONMENT
# =============================================================================
# Applied to all PostgreSQL clusters in prd environment.
# Service-specific values in <service>-db.yaml override these.
# =============================================================================

type: postgresql

version:
  postgresql: "17"

cluster:
  instances: 1

  storage:
    storageClass: longhorn

  resources:
    requests:
      cpu: 250m
      memory: 512Mi
    limits:
      cpu: "1"
      memory: 1Gi

  monitoring:
    enabled: true
    podMonitor:
      enabled: true
    prometheusRule:
      enabled: true

  affinity:
    topologyKey: kubernetes.io/hostname

  # Exclude from Velero FSB - CNPG uses its own S3 backup
  additionalAnnotations:
    backup.velero.io/backup-volumes-excludes: pgdata
